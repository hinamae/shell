#!/bin/bash

#設定ファイルを読み込むスクリプトで実行中に設定ファイルを書き換えたあろ、プロセスを止めずに設定ファイルを読み込みさせたい時

#環境初期化のシェル変数。ログ出力先を設定したsetting.confを読み込む
loadconf(){
#.＝シェルを実行という意味
#ドットコマンドでシェルファイルが読み込まれた場合は、あたかもそのままソースコードがスクリプトに貼り付けられたかのように動作する
	. ./setting.conf
}


#HUPシグナルの割り込みで設定を読み込み直すように定義
#シグナル＝実行中のプロセスに様々な指示を送ることができる
#kill -lでシグナルのリストを見ることができる
#HUPシグナルとは、例えば、webサーバとしてよく使用されるApache httpdでは親プロセスにHUPシグナルを送ると設定ファイルhttpd.confの再読み込みを行うreload動作をする
trap 'loadconf' HUP

#通常起動時の初めのしょきかをおこなう
loadconf

#無限ループで実行

while :
do
	#uptimeコマンドの結果をsetting.confで指定されたログ出力
	uptime >> "${UPTIME_FILENAME}"
	sleep 1
done
